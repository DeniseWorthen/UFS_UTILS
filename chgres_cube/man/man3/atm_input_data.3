.TH "atm_input_data" 3 "Wed Mar 13 2024" "Version 1.13.0" "chgres_cube" \" -*- nroff -*-
.ad l
.nh
.SH NAME
atm_input_data \- 
.PP
Read atmospheric data on the input grid\&.  

.SH SYNOPSIS
.br
.PP
.SS "Public Member Functions"

.in +1c
.ti -1c
.RI "subroutine \fBcalcalpha_rotlatlon\fP (latgrid, longrid, cenlat, cenlon, alpha)"
.br
.RI "\fICalculate rotation angle for rotated latlon grids\&. \fP"
.ti -1c
.RI "subroutine, public \fBcleanup_input_atm_data\fP"
.br
.RI "\fIFree up memory associated with atm data\&. \fP"
.ti -1c
.RI "subroutine, public \fBconvert_winds_to_xyz\fP"
.br
.RI "\fIConvert winds from 2-d to 3-d components\&. \fP"
.ti -1c
.RI "subroutine, public \fBread_input_atm_data\fP (localpet)"
.br
.RI "\fIRead input grid atmospheric data driver\&. \fP"
.ti -1c
.RI "subroutine \fBread_input_atm_gfs_gaussian_nemsio_file\fP (localpet)"
.br
.RI "\fIRead input atmospheric data from spectral gfs (global gaussian in nemsio format\&. \fP"
.ti -1c
.RI "subroutine \fBread_input_atm_grib2_file\fP (localpet)"
.br
.RI "\fIRead input grid atmospheric fv3gfs grib2 files\&. \fP"
.ti -1c
.RI "subroutine \fBread_input_atm_tiled_history_file\fP (localpet)"
.br
.RI "\fIRead input grid fv3 atmospheric tiled history files in netcdf format\&. \fP"
.ti -1c
.RI "subroutine \fBread_winds\fP (u, v, localpet, octet_23, rlevs, lugb, pdt_num)"
.br
.RI "\fIRead winds from a grib2 file\&. \fP"
.in -1c
.SS "Data Fields"

.in +1c
.ti -1c
.RI "type(esmf_field), public \fBdzdt_input_grid\fP"
.br
.RI "\fIvert velocity \fP"
.ti -1c
.RI "integer, public \fBlev_input\fP"
.br
.RI "\fInumber of atmospheric layers \fP"
.ti -1c
.RI "integer, public \fBlevp1_input\fP"
.br
.RI "\fInumber of atmos layer interfaces \fP"
.ti -1c
.RI "type(esmf_field), public \fBpres_input_grid\fP"
.br
.RI "\fI3-d pressure \fP"
.ti -1c
.RI "type(esmf_field), public \fBps_input_grid\fP"
.br
.RI "\fIsurface pressure \fP"
.ti -1c
.RI "type(esmf_field), public \fBtemp_input_grid\fP"
.br
.RI "\fItemperature \fP"
.ti -1c
.RI "type(esmf_field), public \fBterrain_input_grid\fP"
.br
.RI "\fIterrain height \fP"
.ti -1c
.RI "type(esmf_field), dimension(:), 
.br
allocatable, public \fBtracers_input_grid\fP"
.br
.RI "\fItracers \fP"
.ti -1c
.RI "type(esmf_field), public \fBu_input_grid\fP"
.br
.RI "\fIu/v wind at grid \fP"
.ti -1c
.RI "type(esmf_field), public \fBv_input_grid\fP"
.br
.RI "\fIbox center \fP"
.ti -1c
.RI "type(esmf_field), public \fBxwind_input_grid\fP"
.br
.RI "\fIx-component wind \fP"
.ti -1c
.RI "type(esmf_field), public \fBywind_input_grid\fP"
.br
.RI "\fIy-component wind \fP"
.ti -1c
.RI "type(esmf_field), public \fBzwind_input_grid\fP"
.br
.RI "\fIz-component wind \fP"
.in -1c
.SS "Private Member Functions"

.in +1c
.ti -1c
.RI "subroutine \fBgridrot\fP (lov, latin1, latin2, lon, rot)"
.br
.RI "\fICompute grid rotation angle for non-latlon grids\&. \fP"
.ti -1c
.RI "subroutine \fBinit_atm_esmf_fields\fP"
.br
.RI "\fICreate atmospheric esmf fields\&. \fP"
.ti -1c
.RI "subroutine \fBread_input_atm_gaussian_nemsio_file\fP (localpet)"
.br
.RI "\fIRead input grid atmospheric fv3 gaussian nemsio files\&. \fP"
.ti -1c
.RI "subroutine \fBread_input_atm_gaussian_netcdf_file\fP (localpet)"
.br
.RI "\fIRead fv3 netcdf gaussian history file\&. \fP"
.ti -1c
.RI "subroutine \fBread_input_atm_gfs_sigio_file\fP (localpet)"
.br
.RI "\fIRead input atmospheric data from spectral gfs (old sigio format)\&. \fP"
.ti -1c
.RI "subroutine \fBread_input_atm_restart_file\fP (localpet)"
.br
.RI "\fIRead input grid fv3 atmospheric data 'warm' restart files\&. \fP"
.in -1c
.SS "Private Attributes"

.in +1c
.ti -1c
.RI "type(esmf_field) \fBdpres_input_grid\fP"
.br
.RI "\fIpressure thickness \fP"
.ti -1c
.RI "character(len=50), dimension(:), 
.br
allocatable, private \fBslevs\fP"
.br
.RI "\fIThe atmospheric levels in the GRIB2 input file\&. \fP"
.in -1c
.SH "Detailed Description"
.PP 
Read atmospheric data on the input grid\&. 

Supported formats include fv3 tiled 'restart' files, fv3 tiled 'history' files, fv3 gaussian history files, spectral gfs gaussian nemsio files, and spectral gfs sigio/sfcio files\&.
.PP
Public variables are defined below: 'input' indicates field associated with the input grid\&.
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 15 of file atm_input_data\&.F90\&.
.SH "Member Function/Subroutine Documentation"
.PP 
.SS "subroutine atm_input_data::calcalpha_rotlatlon (real(esmf_kind_r8), dimension(i_input,j_input), intent(in)latgrid, longrid, real(esmf_kind_r4), intent(in)cenlat, real(esmf_kind_r4), intent(in)cenlon, real(esmf_kind_r4), dimension(i_input,j_input), intent(out)alpha)"

.PP
Calculate rotation angle for rotated latlon grids\&. Needed to convert to earth-relative winds\&.
.PP
\fBParameters:\fP
.RS 4
\fIlatgrid\fP grid latitudes 
.br
\fIlongrid\fP grid longitudes 
.br
\fIcenlat\fP center latitude 
.br
\fIcenlon\fP center longitude 
.br
\fIalpha\fP grid rotation angle 
.RE
.PP
\fBAuthor:\fP
.RS 4
Larissa Reames 
.RE
.PP

.PP
Definition at line 3251 of file atm_input_data\&.F90\&.
.PP
Referenced by read_winds()\&.
.SS "subroutine, public atm_input_data::cleanup_input_atm_data ()"

.PP
Free up memory associated with atm data\&. 
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 3290 of file atm_input_data\&.F90\&.
.PP
Referenced by atmosphere::atmosphere_driver()\&.
.SS "subroutine, public atm_input_data::convert_winds_to_xyz ()"

.PP
Convert winds from 2-d to 3-d components\&. 
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 3120 of file atm_input_data\&.F90\&.
.PP
References utilities::error_handler()\&.
.PP
Referenced by read_input_atm_gaussian_nemsio_file(), read_input_atm_gaussian_netcdf_file(), read_input_atm_gfs_gaussian_nemsio_file(), read_input_atm_gfs_sigio_file(), read_input_atm_grib2_file(), read_input_atm_restart_file(), and read_input_atm_tiled_history_file()\&.
.SS "subroutine atm_input_data::gridrot (real(esmf_kind_r4), intent(in)lov, real(esmf_kind_r4), intent(in)latin1, real(esmf_kind_r4), intent(in)latin2, real(esmf_kind_r8), dimension(i_input,j_input), intent(in)lon, real(esmf_kind_r4), dimension(i_input,j_input), intent(inout)rot)\fC [private]\fP"

.PP
Compute grid rotation angle for non-latlon grids\&. 
.PP
\fBNote:\fP
.RS 4
The original gridrot subroutine was specific to polar stereographic grids\&. We need to compute it for Lambert Conformal grids\&. So we need lat1,lat2\&. This follows the ncl_ncarg source code: ncl_ncarg-6\&.6\&.2/ni/src/ncl/GetGrids\&.c
.RE
.PP
\fBParameters:\fP
.RS 4
\fIlov\fP orientation angle 
.br
\fIlatin1\fP first tangent latitude 
.br
\fIlatin2\fP second tangent latitude 
.br
\fIlon\fP longitude 
.br
\fIrot\fP rotation angle 
.RE
.PP
\fBAuthor:\fP
.RS 4
Larissa Reames 
.RE
.PP

.PP
Definition at line 3210 of file atm_input_data\&.F90\&.
.PP
Referenced by read_winds()\&.
.SS "subroutine atm_input_data::init_atm_esmf_fields ()\fC [private]\fP"

.PP
Create atmospheric esmf fields\&. 
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 147 of file atm_input_data\&.F90\&.
.PP
References utilities::error_handler()\&.
.PP
Referenced by read_input_atm_gaussian_nemsio_file(), read_input_atm_gaussian_netcdf_file(), read_input_atm_gfs_gaussian_nemsio_file(), read_input_atm_gfs_sigio_file(), read_input_atm_grib2_file(), read_input_atm_restart_file(), and read_input_atm_tiled_history_file()\&.
.SS "subroutine, public atm_input_data::read_input_atm_data (integer, intent(in)localpet)"

.PP
Read input grid atmospheric data driver\&. 
.PP
\fBParameters:\fP
.RS 4
\fIlocalpet\fP ESMF local persistent execution thread 
.RE
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 77 of file atm_input_data\&.F90\&.
.PP
References read_input_atm_gaussian_nemsio_file(), read_input_atm_gaussian_netcdf_file(), read_input_atm_gfs_gaussian_nemsio_file(), read_input_atm_gfs_sigio_file(), read_input_atm_grib2_file(), read_input_atm_restart_file(), and read_input_atm_tiled_history_file()\&.
.PP
Referenced by atmosphere::atmosphere_driver()\&.
.SS "subroutine atm_input_data::read_input_atm_gaussian_nemsio_file (integer, intent(in)localpet)\fC [private]\fP"

.PP
Read input grid atmospheric fv3 gaussian nemsio files\&. 
.PP
\fBParameters:\fP
.RS 4
\fIlocalpet\fP ESMF local persistent execution thread 
.RE
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 753 of file atm_input_data\&.F90\&.
.PP
References convert_winds_to_xyz(), utilities::error_handler(), and init_atm_esmf_fields()\&.
.PP
Referenced by read_input_atm_data()\&.
.SS "subroutine atm_input_data::read_input_atm_gaussian_netcdf_file (integer, intent(in)localpet)\fC [private]\fP"

.PP
Read fv3 netcdf gaussian history file\&. Each task reads a horizontal slice\&.
.PP
\fBParameters:\fP
.RS 4
\fIlocalpet\fP ESMF local persistent execution thread 
.RE
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 1295 of file atm_input_data\&.F90\&.
.PP
References convert_winds_to_xyz(), utilities::error_handler(), init_atm_esmf_fields(), and utilities::netcdf_err()\&.
.PP
Referenced by read_input_atm_data()\&.
.SS "subroutine atm_input_data::read_input_atm_gfs_gaussian_nemsio_file (integer, intent(in)localpet)"

.PP
Read input atmospheric data from spectral gfs (global gaussian in nemsio format\&. Starting July 19, 2017)\&.
.PP
\fBParameters:\fP
.RS 4
\fIlocalpet\fP ESMF local persistent execution thread 
.RE
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 500 of file atm_input_data\&.F90\&.
.PP
References convert_winds_to_xyz(), utilities::error_handler(), and init_atm_esmf_fields()\&.
.PP
Referenced by read_input_atm_data()\&.
.SS "subroutine atm_input_data::read_input_atm_gfs_sigio_file (integer, intent(in)localpet)\fC [private]\fP"

.PP
Read input atmospheric data from spectral gfs (old sigio format)\&. 
.PP
\fBNote:\fP
.RS 4
Format used prior to July 19, 2017\&. 
.RE
.PP
\fBParameters:\fP
.RS 4
\fIlocalpet\fP ESMF local persistent execution thread 
.RE
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 261 of file atm_input_data\&.F90\&.
.PP
References convert_winds_to_xyz(), utilities::error_handler(), and init_atm_esmf_fields()\&.
.PP
Referenced by read_input_atm_data()\&.
.SS "subroutine atm_input_data::read_input_atm_grib2_file (integer, intent(in)localpet)"

.PP
Read input grid atmospheric fv3gfs grib2 files\&. 
.PP
\fBParameters:\fP
.RS 4
\fIlocalpet\fP ESMF local persistent execution thread 
.RE
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 1970 of file atm_input_data\&.F90\&.
.PP
References grib2_util::convert_omega(), convert_winds_to_xyz(), utilities::dint2p(), utilities::error_handler(), program_setup::get_var_cond(), utilities::handle_grib_error(), init_atm_esmf_fields(), utilities::quicksort(), read_winds(), grib2_util::rh2spfh(), and grib2_util::rh2spfh_gfs()\&.
.PP
Referenced by read_input_atm_data()\&.
.SS "subroutine atm_input_data::read_input_atm_restart_file (integer, intent(in)localpet)\fC [private]\fP"

.PP
Read input grid fv3 atmospheric data 'warm' restart files\&. 
.PP
\fBNote:\fP
.RS 4
Routine reads tiled files in parallel\&. Tile 1 is read by localpet 0; tile 2 by localpet 1, etc\&. The number of pets must be equal to or greater than the number of tiled files\&. Logic only tested with global input data of six tiles\&. 
.RE
.PP
\fBParameters:\fP
.RS 4
\fIlocalpet\fP ESMF local persistent execution thread 
.RE
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 1036 of file atm_input_data\&.F90\&.
.PP
References convert_winds_to_xyz(), utilities::error_handler(), init_atm_esmf_fields(), and utilities::netcdf_err()\&.
.PP
Referenced by read_input_atm_data()\&.
.SS "subroutine atm_input_data::read_input_atm_tiled_history_file (integer, intent(in)localpet)"

.PP
Read input grid fv3 atmospheric tiled history files in netcdf format\&. 
.PP
\fBNote:\fP
.RS 4
Routine reads tiled files in parallel\&. Tile 1 is read by localpet 0; tile 2 by localpet 1, etc\&. The number of pets must be equal to or greater than the number of tiled files\&.
.RE
.PP
\fBParameters:\fP
.RS 4
\fIlocalpet\fP ESMF local persistent execution thread 
.RE
.PP
\fBAuthor:\fP
.RS 4
George Gayno NCEP/EMC 
.RE
.PP

.PP
Definition at line 1679 of file atm_input_data\&.F90\&.
.PP
References convert_winds_to_xyz(), utilities::error_handler(), init_atm_esmf_fields(), and utilities::netcdf_err()\&.
.PP
Referenced by read_input_atm_data()\&.
.SS "subroutine atm_input_data::read_winds (real(esmf_kind_r8), dimension(:,:,:), intent(inout), allocatableu, real(esmf_kind_r8), dimension(:,:,:), intent(inout), allocatablev, integer, intent(in)localpet, integer, intent(in)octet_23, real(esmf_kind_r8), dimension(\fBlev_input\fP), intent(in)rlevs, integer, intent(in)lugb, integer, intent(in)pdt_num)"

.PP
Read winds from a grib2 file\&. Rotate winds to be earth relative if necessary\&.
.PP
\fBParameters:\fP
.RS 4
\fIu\fP u-component wind 
.br
\fIv\fP v-component wind 
.br
\fIlocalpet\fP ESMF local persistent execution thread 
.br
\fIoctet_23\fP Section 4/Octet 23 - Type of first fixed surface\&. 
.br
\fIrlevs\fP Array of atmospheric level values 
.br
\fIlugb\fP Logical unit number of GRIB2 file\&. 
.br
\fIpdt_num\fP Product definition template number\&. 
.RE
.PP
\fBAuthor:\fP
.RS 4
Larissa Reames 
.RE
.PP

.PP
Definition at line 2937 of file atm_input_data\&.F90\&.
.PP
References calcalpha_rotlatlon(), utilities::error_handler(), program_setup::get_var_cond(), gridrot(), and utilities::handle_grib_error()\&.
.PP
Referenced by read_input_atm_grib2_file()\&.
.SH "Field Documentation"
.PP 
.SS "type(esmf_field) atm_input_data::dpres_input_grid\fC [private]\fP"

.PP
pressure thickness 
.PP
Definition at line 49 of file atm_input_data\&.F90\&.
.SS "type(esmf_field), public atm_input_data::dzdt_input_grid"

.PP
vert velocity 
.PP
Definition at line 48 of file atm_input_data\&.F90\&.
.SS "integer, public atm_input_data::lev_input"

.PP
number of atmospheric layers 
.PP
Definition at line 62 of file atm_input_data\&.F90\&.
.SS "integer, public atm_input_data::levp1_input"

.PP
number of atmos layer interfaces 
.PP
Definition at line 63 of file atm_input_data\&.F90\&.
.SS "type(esmf_field), public atm_input_data::pres_input_grid"

.PP
3-d pressure 
.PP
Definition at line 50 of file atm_input_data\&.F90\&.
.SS "type(esmf_field), public atm_input_data::ps_input_grid"

.PP
surface pressure 
.PP
Definition at line 51 of file atm_input_data\&.F90\&.
.SS "character(len=50), dimension(:), allocatable, private atm_input_data::slevs\fC [private]\fP"

.PP
The atmospheric levels in the GRIB2 input file\&. 
.PP
Definition at line 65 of file atm_input_data\&.F90\&.
.SS "type(esmf_field), public atm_input_data::temp_input_grid"

.PP
temperature 
.PP
Definition at line 53 of file atm_input_data\&.F90\&.
.SS "type(esmf_field), public atm_input_data::terrain_input_grid"

.PP
terrain height 
.PP
Definition at line 52 of file atm_input_data\&.F90\&.
.SS "type(esmf_field), dimension(:), allocatable, public atm_input_data::tracers_input_grid"

.PP
tracers 
.PP
Definition at line 60 of file atm_input_data\&.F90\&.
.SS "type(esmf_field), public atm_input_data::u_input_grid"

.PP
u/v wind at grid 
.PP
Definition at line 55 of file atm_input_data\&.F90\&.
.SS "type(esmf_field), public atm_input_data::v_input_grid"

.PP
box center 
.PP
Definition at line 56 of file atm_input_data\&.F90\&.
.SS "type(esmf_field), public atm_input_data::xwind_input_grid"

.PP
x-component wind 
.PP
Definition at line 57 of file atm_input_data\&.F90\&.
.SS "type(esmf_field), public atm_input_data::ywind_input_grid"

.PP
y-component wind 
.PP
Definition at line 58 of file atm_input_data\&.F90\&.
.SS "type(esmf_field), public atm_input_data::zwind_input_grid"

.PP
z-component wind 
.PP
Definition at line 59 of file atm_input_data\&.F90\&.

.SH "Author"
.PP 
Generated automatically by Doxygen for chgres_cube from the source code\&.
