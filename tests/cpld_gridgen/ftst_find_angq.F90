! Unit test for cpld_gridgen routine "find_angq".
!
! Reads a sample MOM6 supergrid and calculates the
! rotation angle on corner points
!
! Author Denise Worthen 2/08/2022

  program angq

  implicit none

  integer, parameter :: ni = 12, nj = 7
  integer, parameter :: nx = 2*ni
  integer, parameter :: ny = 2*nj

  real(kind=4), dimension(0:nx,0:ny) :: sgx
  real(kind=4), dimension(0:nx,0:ny) :: sgy

  data sgx  /65.00,   70.69,   75.41,   79.51,   83.20,   86.66,   90.00,   86.66,   83.20,   79.51,   75.41,   70.69,   65.00,   70.69,   75.41,   79.51,   83.20,   86.66,   90.00,   86.66,   83.20,   79.51,   75.41,   70.69,   65.00, &
             65.00,   68.57,   71.60,   74.06,   75.92,   77.09,   77.50,   77.09,   75.92,   74.06,   71.60,   68.57,   65.00,   68.57,   71.60,   74.06,   75.92,   77.09,   77.50,   77.09,   75.92,   74.06,   71.60,   68.57,   65.00, &
             65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00,   65.00, &
             52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50,   52.50, &
             40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00,   40.00, &
             27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50,   27.50, &
             15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00,   15.00, &
              2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50,    2.50, &
            -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00,  -10.00, &
            -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50,  -22.50, &
            -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00,  -35.00, &
            -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50,  -47.50, &
            -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00,  -60.00, &
            -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50,  -72.50, &
            -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00,  -85.00/

  data sgy   /-280.00, -280.00, -280.00, -280.00, -280.00, -280.00, -100.00, -100.00, -100.00, -100.00, -100.00, -100.00, -100.00, -100.00, -100.00, -100.00, -100.00, -100.00, -100.00,   80.00,   80.00,   80.00,   80.00,   80.00,   80.00, &
              -280.00, -267.99, -255.37, -241.54, -226.02, -208.64, -190.00, -171.36, -153.98, -138.46, -124.63, -112.01, -100.00,  -87.99,  -75.37,  -61.54,  -46.02,  -28.64,  -10.00,    8.64,   26.02,   41.54,   55.37,   67.99,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00, &
              -280.00, -265.00, -250.00, -235.00, -220.00, -205.00, -190.00, -175.00, -160.00, -145.00, -130.00, -115.00, -100.00,  -85.00,  -70.00,  -55.00,  -40.00,  -25.00,  -10.00,    5.00,   20.00,   35.00,   50.00,   65.00,   80.00/

  print *,"Starting test of cpld_gridgen routine find_angq"

  end program angq
